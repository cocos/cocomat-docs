(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{460:function(t,a,s){"use strict";s.r(a);var n=s(65),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"ccmscenemanager"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ccmscenemanager"}},[t._v("#")]),t._v(" CCMSceneManager")]),t._v(" "),s("h2",{attrs:{id:"概述"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#概述"}},[t._v("#")]),t._v(" 概述")]),t._v(" "),s("p",[s("code",[t._v("CCMSceneManager")]),t._v(" 主要是受 Android Activity 启动模式启发，将其启动模式复刻到了 CocosCreator。"),s("code",[t._v("CCMSceneManager")]),t._v(" 将原来无序的场景启动和返回，放到栈中进行管理，让返回场景、特殊的启动场景变得简单。并提供了场景间传递数据的功能，否则开发者需要通过全局变量或者挂载永久节点的方式来实现。")]),t._v(" "),s("h2",{attrs:{id:"使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用"}},[t._v("#")]),t._v(" 使用")]),t._v(" "),s("p",[s("code",[t._v("CCMSceneManager")]),t._v(" 主要提供了 "),s("code",[t._v("startScene")]),t._v("、"),s("code",[t._v("backScene")]),t._v(" 两个 api 调用。简单理解就是 startScene 启动场景，backScene 返回界面，并且可以通过这两个方法在场景间传递数据。")]),t._v(" "),s("h3",{attrs:{id:"启动场景-ccmscenemanager-getinstance-startscene"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动场景-ccmscenemanager-getinstance-startscene"}},[t._v("#")]),t._v(" 启动场景 "),s("code",[t._v("CCMSceneManager.getInstance().startScene()")])]),t._v(" "),s("h4",{attrs:{id:"使用示例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用示例"}},[t._v("#")]),t._v(" 使用示例")]),t._v(" "),s("div",{staticClass:"language-typescript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-typescript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// start scene")]),t._v("\nCCMSceneManager"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getInstance")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("startScene")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'sceneName'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// start scene with data")]),t._v("\nCCMSceneManager"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getInstance")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("startScene")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'sceneName'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"yourData"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// start scene with startMode, default is STANDARD")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// standard mode")]),t._v("\nCCMSceneManager"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getInstance")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("startScene")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'sceneName'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"yourData"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" StartSceneMode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("STANDARD")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// single top mode")]),t._v("\nCCMSceneManager"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getInstance")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("startScene")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'sceneName'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"yourData"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" StartSceneMode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("SINGLE_TOP")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h4",{attrs:{id:"详解"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#详解"}},[t._v("#")]),t._v(" 详解")]),t._v(" "),s("p",[s("code",[t._v("startScene")]),t._v(" 其实就是使用了 "),s("code",[t._v("cc.director.loadScene")]),t._v(" 方法来加载场景。在其中处理了场景栈的操作和数据的保存。")]),t._v(" "),s("p",[t._v("数据传递较为简单，在 "),s("code",[t._v("startScene")]),t._v(" 参数中传递 data 选项即可。")]),t._v(" "),s("p",[t._v("值得说的是 "),s("code",[t._v("startScene")]),t._v(" 的启动模式，这里借鉴了 Android Activity 的几个启动模式：标准模式、清栈模式、栈顶模式、临时场景。")]),t._v(" "),s("ol",[s("li",[s("code",[t._v("StartSceneMode.STANDARD")]),t._v(" 标准模式：默认为此模式，此模式下，"),s("code",[t._v("startScene")]),t._v(" 会执行场景压栈操作记录下来，"),s("code",[t._v("backScene")]),t._v(" 时可以直接读取栈中信息，开发者无需了解上一个场景是谁即可实现场景的返回逻辑；")]),t._v(" "),s("li",[s("code",[t._v("StartSceneMode.CLEAR_STACK")]),t._v(" 清栈模式：即清空当前栈中所有场景，然后将指定场景入栈。通常在启动 home 这种根界面的情况下使用此模式；")]),t._v(" "),s("li",[s("code",[t._v("StartSceneMode.TEMPORARY")]),t._v(" 临时场景：当希望启动一个不希望被栈记录的场景时使用此模式。比如当启动场景顺序为 A——>B——>C，但是返回时希望 C——>A，忽略 B 场景，此时启动时对 B 使用临时场景模式即可；")]),t._v(" "),s("li",[s("code",[t._v("StartSceneMode.SINGLE_TOP")]),t._v(" 栈顶模式：当压栈时，如果栈中已有此场景，则先将其出栈。当希望栈中一种场景只有一个存在时使用此模式，此模式应用场景较少。")])]),t._v(" "),s("h3",{attrs:{id:"返回上一场景-ccmscenemanager-getinstance-backscene"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#返回上一场景-ccmscenemanager-getinstance-backscene"}},[t._v("#")]),t._v(" 返回上一场景 "),s("code",[t._v("CCMSceneManager.getInstance().backScene()")])]),t._v(" "),s("h4",{attrs:{id:"使用示例-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用示例-2"}},[t._v("#")]),t._v(" 使用示例")]),t._v(" "),s("div",{staticClass:"language-typescript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-typescript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// back scene")]),t._v("\nCCMSceneManager"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getInstance")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("backScene")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// back scene with data")]),t._v("\nCCMSceneManager"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getInstance")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("backScene")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"yourData"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// listen scene loaded callback")]),t._v("\nCCMSceneManager"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getInstance")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("backScene")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"yourData"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// scene loaded callback")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h4",{attrs:{id:"详解-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#详解-2"}},[t._v("#")]),t._v(" 详解")]),t._v(" "),s("p",[t._v("和 "),s("code",[t._v("startScene")]),t._v(" 类似，"),s("code",[t._v("backScene")]),t._v(" 也是使用了 "),s("code",[t._v("cc.director.loadScene")]),t._v(" 方法来加载场景。并在其中处理了场景栈的操作和数据的传递。")]),t._v(" "),s("p",[t._v("和 "),s("code",[t._v("startScene")]),t._v(" 不同，"),s("code",[t._v("backScene")]),t._v(" 需要查找场景栈，了解自己需要返回哪个场景，并处理临时场景的逻辑。")]),t._v(" "),s("h3",{attrs:{id:"场景间传递数据"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#场景间传递数据"}},[t._v("#")]),t._v(" 场景间传递数据")]),t._v(" "),s("h4",{attrs:{id:"使用示例-3"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用示例-3"}},[t._v("#")]),t._v(" 使用示例")]),t._v(" "),s("div",{staticClass:"language-typescript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-typescript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// pass data")]),t._v("\nCCMSceneManager"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getInstance")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("startScene")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'sceneName'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yourData'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// get data")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" sceneData "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CCMSceneManager"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getInstance")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getSceneData")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])])}),[],!1,null,null,null);a.default=e.exports}}]);